# This readme file describes the program used to prepare the records of my cryptocurrency activity for filing to the tax authorities

## Purpose

The purpose of the program is to scrape data from 2020 and organize files I have on my trading activity so as to prepare documents for filing taxes to the authorities in the countries where I am registered.

## Structure

The program is written predominantly in R. Not all files are published publicly.

## File Organization

1. `readme.md`  
    The file you are currently reading.  
2. `.gitignore`  
    File with instructions of what not to make public (not public).   
3. `inputs/`  
    Contains the files containing data used by the scripts (not public).  
    * `02_years_of_interest.xlsx`  
    Contains information about which years I will prepare tax documents for.  
    * `03_irs_exchange_rates.xlsx`  
    Contains manually input data from the [IRS website](https://www.irs.gov/individuals/international-taxpayers/yearly-average-currency-exchange-rates)    
    * `06_cc_ticker_lookup_table.xlsx`  
    Contains information regarding crypto currencies to track (not public).  
    * `07_all_trades_all_years/`  
    Contains raw data from all of the trades I did on Gatehub, Bitfinex, Transferwise, ande Kraken since 2017 (not public).  
    * `09_skatteverket_parameters.xlsx`  
    Contains manually obtained parameters for estimating tax burden to Skatteverket.  
    * `not_programmatically_evaluated/`  
        Contains documents required for filing taxes but which were not used by `program.r` (not public).  
4. `scripts/`  
    1. `00_taxes_2019_program.r`  
    This program will prompt the user to verify that appropriate data are uploaded in the `inputs/` and `outputs/` directories. If the user validates this, the program will generate the workbook needed for the accountants into the `outputs/` directory.  
    1. `01_my_fxns_this_project.r`  
    Sources custom functions (not public).  
    1. `02_dates_of_interest.r`  
    Generates values and a list that will be used in other scripts.  
    1. `03_fiat_exchange_rates.r`  
    Makes table for the fiat exchange rates in the timeframe based on [Riksbanken's published data](https://www.riksbank.se/sv/).  
    Also pulls data from `03_irs_exchange_rates.xlsx`.  
    1. `04_usd_xau__rates.r`  
    Makes table for the gold to US dollar exchange rates in the timeframe.  
    1. `05_scraping_historical_cc_rates.r`  
    Scrapes historical crypto currency rates into `.rda` files.  
    1. `06_all_exchange_rates.r`  
    Makes tables that show the daily exchange rates for all of my cryptocurrencies, fiat, and gold (XAU) against USD and SEK.  
    1. `07_all_trades_all_years.r`  
    Consolidates all of the raw data I have exported from the exchanges I have used. There is also some hard-coded manual cleanup in this job since the exchanges provided incomplete/inaccurate records at times.  
    1. `08_fifo.r`  
    Makes table including first-in-first-out accounting for all the trades. Also creates subsets of fifo trades for each year. For Skatteverket this means that all years after 2017 have rows added at the beginning to represent the "first purchase of the year" to establish the cost paid for assets from previous years; these data are taken from the final row of the fifo data from the previous year's subset. In this way, all data reported to Skatteverket are truly treated as short-term positions since I indicate I make a purchase first at the beginning of each year.  
    1. `09_tax_reporting.r`  
    Makes tables for each year that can be used for reporting to the Swedish tax authority. The tables made include:  
        1. a table with all trades (buys and sells)  
        2. a table summarizing overall profits/losses per asset type  
        3. a table showing the overall profits/loss for the year and estimated tax burden  

        Also makes tables for each year that can be used for reporting to the IRS. The tables made include:  
        1. a table with all sales  
        2. a table showing the overall profits/loss for the year based on the table with all sales  
        3. a table summarizing overall profits/losses per asset type  
        4. a table showing the overall profits/loss for the year based on the table that has summarized overall gains/losses per asset type.
    1.  `make_workbooks_for_accountant.r`  
    This script generates the excel workbook to be given to my accountant.  
5. `outputs/`  
    Contains the files newly generated by the scripts. Most of this is not public.  
    * `05_cmc/`  
